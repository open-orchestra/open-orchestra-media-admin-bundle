{% macro buildMenuFolder(folders, mediaType, skin, first) %}
    {% import 'OpenOrchestraMediaAdminBundle:Tree:menu_macros_' ~ skin ~ '.html.twig' as menu_macros %}
    {% for folder in folders %}

        {% if is_granted('ACTION_READ', folder) %}
            <li>
                {{ menu_macros.node_folder(folder, mediaType) }}
            {% if folder.subFolders is not empty or is_granted('ACTION_CREATE', folder) %}
                <ul>
                    {% if folder.subFolders is not empty %}
                        {{ _self.buildMenuFolder(folder.subFolders(), mediaType, skin, 'child') }}
                    {% endif %}
                    {% if is_granted('ACTION_CREATE', folder) %}
                        {{ menu_macros.new_folder(folder.id) }}
                    {% endif %}
                </ul>
            {% endif %}
            </li>
        {% endif %}

    {% endfor %}
    {% if first == 'first' %}
        {{ menu_macros.new_folder('-') }}
    {% endif %}
{% endmacro %}
